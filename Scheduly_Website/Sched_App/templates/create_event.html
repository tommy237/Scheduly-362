{% extends "base.html" %}
{% load static %}

{% block title %}New Event{% endblock %}

{% block content %}
  <h1>Create Event</h1>
  <form method="post" id="event-form">
    {% csrf_token %}

    <p>{{ form.title.label_tag }}<br>{{ form.title }}</p>
    <p>{{ form.description.label_tag }}<br>{{ form.description }}</p>

    <p>
      {{ form.all_day }} {{ form.all_day.label_tag }}
    </p>

    <div id="datetime-fields">
      <p>{{ form.start_date.label_tag }}<br>{{ form.start_date }}</p>
      <p>{{ form.start_time.label_tag }}<br>{{ form.start_time }}</p>
      <p>{{ form.end_date.label_tag }}<br>{{ form.end_date }}</p>
      <p>{{ form.end_time.label_tag }}<br>{{ form.end_time }}</p>
    </div>

    <button type="submit">Save Event</button>
  </form>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', () => {
      const allDay   = document.getElementById('id_all_day');
      const dtFields = document.getElementById('datetime-fields');
      const dtInputs = dtFields.querySelectorAll('input');
    
      function toggle() {
        if (allDay.checked) {
          dtFields.style.display = 'none';
          dtInputs.forEach(i => {
            i.disabled = true;
            i.required = false;
          });
        } else {
          dtFields.style.display = 'block';
          dtInputs.forEach(i => {
            i.disabled = false;
            if (i.type === 'date') i.required = true;
          });
        }
      }
    
      allDay.addEventListener('change', toggle);
      toggle();
    });
    </script>    
{% endblock %}
